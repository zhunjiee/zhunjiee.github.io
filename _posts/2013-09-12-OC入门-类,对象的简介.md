---
layout: post
title: "OC入门-类,对象的简介"
date: 2013-09-12
comments: false
categories: ObjC
---

##1.如何声明一个类
- 格式

```objc
@interface MyClass : NSObject
{
    int    count;
    id    data;
    NSString *name;
}

- (id)initWithString:(NSString *)aName;
+ (MyClass *)createMyClassWithString:(NSString *)aName;
```

- 注意：
    + 1.必须以@interface开头，@end结尾
    + 2.成员变量的声明，必须写在@interface与@end之间的大括号中
    + 3.方法的声明必须在{}下面，不能写在{}中

---

##2.如何实现一个类
- 格式

```
@implementation MyClass

- (id)initWithString:(NSString *)aName
{
    //写代码处
}

+ (MyClass *)myClassWithString:(NSString *)aName
{
    //写代码处
}

@end

```
- 注意：
    + 1.必须以@implementation开头，@end结尾
    + 2.类名必须和声明的一致

##3.如何创建一个对象
- 用类的方式告诉计算机，我们需要一个什么样的对象，之后我们要在程序中使用这个对象，就必须先创建一个对象

```objc
Car *car = [Car new];
```

- 注意[Car new];做了三件事
    + 1.在堆内存中开辟了一块新的存储空间
    + 2.初始化成员变量(写在类声明大括号中的属性就叫成员变量,也叫实例变量)
    + 3.返回指针地址

- 消息机制
    + 使用对象调用方法就是OC中的消息机制
    + OC中调用方法的格式：[类名或者对象名 方法名];

```objc
Car *car = [Car new];
// 向car对象发送了一条调用run方法的消息
[car run];
```

##4.对象的注意点
- 可以通过 对象->对象成员(注意声明属性为:@public) 的方式访问对象中的成员,
- 每一个对象中都有一份属于自己的属性。
- 对其中一个对象的成员进行了修改。和另一个对象没有关系

---

# 对象方法的声明和实现

##1.对象方法声明
- 格式

```objc
- (void)insertObject:(id)anObject atIndex:(NSUInteger)index;
```

- 特征
    + 对象方法以-开头如 -(void)xx;
    + 对象方法只能由对象来调用
    + 对象方法中可以访问当前对象的成员变量
    + 调用格式 [对象名 对象方法名];

- 示例

```
//声明没有返回值的方法
- (void)method;
//声明有返回值的方法
- (int)method;
//声明有返回值有参数的方法
- (int)method: (int)var;
//声明有返回值有多个参数的方法
- (int)method: (int)var1 andVar2: (int)var2;

```
---

##2.对象方法实现

    + 必须卸载以@implementation开头，@end之间
    + 在声明的后面加上{}即表示实现
    + 讲需要实现的代码写在{}中

---

# 类方法的声明和实现

---

##1.类方法声明
- 格式
    + 将对象方法-号变为+号

- 特征
    + 类方法以+开头 如+(void)put;
    + 类方法只能由类来调用
    + 类方法中不能访问实例(成员)变量,因为类方法由类来调用,并没有创建存储空间 来存储类中的成员变量。

- 类方法的好处:
    + 节省内存空间
    + 不依赖于对象,执行效率更高;
    + 能用类方法解决的问题,尽量使用类方法;

- 类方法的场合:
    + 当方法内部不需要使用到成员变量时,可以改为类方法
    + 类方法一般用于编写工具方法

- 示例

```
//声明没有返回值的方法
+ (void)method;
//声明有返回值的方法
+ (int)method;
//声明有返回值有参数的方法
+ (int)method: (int)var;
//声明有返回值有多个参数的方法
+ (int)method: (int)var1 andVar2: (int)var2;

```
---

##2.类方法实现
    + 必须卸载以@implementation开头，@end之间
    + 在声明的后面加上{}即表示实现
    + 将需要实现的代码写在{}中

---

##3.对象方法和类方法区别
- 对象方法
    + 对象方法是属于对象的
    + 以减号-开头
    + 只能让对象调用，没有对象，这个方法根本不可能被执行
    + 对象方法能访问实例变量（成员变量）
    + 对象方法中可以调用当前对象的对象方法
    + 对象方法中可以调用其他对象的对象方法
    + 对象方法中部可以调用类方法
- 类方法
    + 类方法是属于类的
    + 以加号+开头
    + 只能用类名调用，对象不能调用
    + 类方法中不能直接访问实例变量（成员变量）
    + 类方法中不能直接调用对象方法，要想调用对象方法，必须创建或传入对象。

- 使用场合：
    + 当不需要访问成员变量的时候，尽量用类方法

- 类方法和对象方法可以同名

# 对象的存储细节
##本小节知识点
1. 对象的存储细节
2. isa指针
3. 使用一个类创建多个对象

##1.对象的存储细节
- 类创建对象,每个对象在内存中都占据一定的存储空间,每个对象都有一份属于自己的单独的成员变量,所有的对象公用类的成员方法,方法在整个内存中只有一份,类本身在内存中占据一份存储空间,类的方法存储于此。

![](https://dn-zhunjiee.qbox.me/Snip20150611_1.png)
---

##2.isa指针
- 每一个对象都包含一个isa指针.这个指针指向当前对象所属的类。
- [p eat];表示给p所指向的对象发送一条eat消息,调用对象的eat方法,此时对象会顺着内部的isa指针找到存 储于类中的方法,执行。
- isa是对象中的隐藏指针,指向创建这个对象的类。
- 通过isa指针我们可以在运行的时候知道当前对象是属于那个Class（类）的
![](https://dn-zhunjiee.qbox.me/Snip20150602_3.png)
---
```
每个Objective－C对象有个指向其具体类的指针 isa。
但Objective-C是一种运行时动态特性很强的语言。
换句话说，Objective-C的运行时动态特性决定了某个对象在生命周期内，
其所属的类是可能改变的，也就是isa指针有可能改变，Apple把这种技术叫做IsA-swizzling。
举个例子，当对某个对象使用了KVO之后，Objective-C实际上是动态的创建了一个该对象所属类的子类，
并把该对象的所属类指向这个子类。
这时候该对象的isa指针就很不幸的被改变了。
实际上，isa指针是Objective-C运行时系统使用到的一个变量，我们在程序中应该尽量不要依赖它。
```
---

##3.使用一个类创建多个对象

```
Car *car1 = [Car new];
Car *car2 = [Car new]
```
![](https://dn-zhunjiee.qbox.me/Snip20150614_2.png)
---
# 函数与方法对比
- 对象方法:
    + (1)方法的实现只能写在@implementation...@end中,方法的声明只能写在 @interface...@end中间
    + (2)对象方法都以-号开头,类方法都以+号开头
    + (3)对象方法只能由对象来调用,类方法只能由类来调用,不能当做函数一样调用
    + (4)函数属于整个文件,可以写在文件中的任何位置,包括@implementation...@end中,但写在 @interface...@end会无法识别,函数的声明可以再main函数内部也可以在main函数外部。
    + (5)方法归类\对象所有
- 函数:
    + (1)所有的函数都是平行的
    + (2)函数不存在隶属关系
    + (3)使用的时候可以直接调用
    + (4)不可以访问对象中的成员变量
